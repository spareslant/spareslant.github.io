<!DOCTYPE html>
<html class="no-js" lang="en-gb">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>SSL Certificate Mutual Authentication - SpareSlant Technical Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/my.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="SpareSlant Technical Blog" rel="home">
				<div class="logo__title">SpareSlant Technical Blog</div>
				<div class="logo__tagline">SpareSlant tech blog</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SSL Certificate Mutual Authentication</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-07-17T21:35:50">2019-07-17</time>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#os-used">os used</a></li>
    <li><a href="#prepare-openssl-conf-files">Prepare openssl conf files</a>
      <ul>
        <li><a href="#create-following-four-config-files">Create following four config files.</a></li>
      </ul>
    </li>
    <li><a href="#create-self-signed-ca-certificate">Create self signed CA certificate.</a></li>
    <li><a href="#check-ca-certificate">Check CA certificate</a></li>
    <li><a href="#verify-ca-certificate">Verify CA certificate</a></li>
    <li><a href="#create-a-csr-request-for-server">Create a CSR request for server.</a></li>
    <li><a href="#create-a-csr-request-for-client">Create a CSR request for client.</a>
      <ul>
        <li><a href="#check-server-csr-request">Check Server CSR request</a></li>
        <li><a href="#check-client-csr-request">Check client CSR request</a></li>
      </ul>
    </li>
    <li><a href="#sign-server-csr-and-generate-server-certificate">Sign Server CSR and generate server certificate</a>
      <ul>
        <li><a href="#check-signed-server-certificate">check signed server certificate</a></li>
        <li><a href="#verify-server-certificate">Verify server certificate</a></li>
      </ul>
    </li>
    <li><a href="#sign-client-csr-and-generate-client-certificate">Sign client CSR and generate client certificate</a>
      <ul>
        <li><a href="#check-client-certificate">check client certificate</a></li>
      </ul>
    </li>
    <li><a href="#verify-clientserver-connectivity-using-certs">Verify Client/Server connectivity using certs.</a></li>
    <li><a href="#attemps-to-connect-and-fetch-a-page-from-server-no-mutual-auth">Attemps to connect and fetch a page from server (NO mutual auth)</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#attemps-to-connect-and-fetch-a-page-from-server-with-mutual-auth">Attemps to connect and fetch a page from server (WITH mutual auth)</a>
      <ul>
        <li><a href="#start-openssl-server-in-client-verification-mode">Start openssl server in client verification mode.</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<h1 id="introduction">Introduction</h1>
<p>We will be creating our own CA (Certificate Authority), CSR (Certificate Signing Request), signed certificate. We will be creating server side and client side certificate and will verify them using <code>openssl</code> and <code>curl</code>.</p>
<h1 id="prepare-environment">Prepare environment</h1>
<h2 id="os-used">os used</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat /etc/fedora-release
Fedora release <span style="color:#ae81ff">30</span> <span style="color:#f92672">(</span>Thirty<span style="color:#f92672">)</span>

$ uname -a
Linux localhost.localdomain 5.0.9-301.fc30.x86_64 <span style="color:#75715e">#1 SMP Tue Apr 23 23:57:35 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>
</code></pre></div><h2 id="prepare-openssl-conf-files">Prepare openssl conf files</h2>
<p>A reference conf file can be found in <code>/etc/pki/tls/openssl.cnf</code> location and by default openssl uses this file. We will be creating our own conf files. One for CA and other one to generate CSRs.</p>
<p><strong>Note:</strong> You do not need to be <code>root</code> to run following commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p myPKI
$ cd mkPKI
$ mkdir -p caCert  caDatabase  CSRs  newCreatedCerts  opensslConf  privateKeys
$ touch caDatabase/index.txt
$ touch caDatabase/serial
$ echo <span style="color:#e6db74">&#34;10&#34;</span> &gt; caDatabase/serial
</code></pre></div><h3 id="create-following-four-config-files">Create following four config files.</h3>
<ul>
<li><code>opensslConf/CA_openssl.cnf</code></li>
<li><code>opensslConf/csr_openssl.cnf</code></li>
<li><code>opensslConf/server_san_names.cnf</code></li>
<li><code>opensslConf/client_san_names.cnf</code></li>
</ul>
<pre><code>$ cat opensslConf/CA_openssl.cnf 
HOME			= .
oid_section		= new_oids

openssl_conf = default_modules
[ default_modules ]
ssl_conf = ssl_module

[ ssl_module ]
system_default = crypto_policy

[ crypto_policy ]
.include = /etc/crypto-policies/back-ends/opensslcnf.config

[ new_oids ]
tsa_policy1 = 1.2.3.4.1
tsa_policy2 = 1.2.3.4.5.6
tsa_policy3 = 1.2.3.4.5.7

[ ca ]
default_ca	= CA_default		# The default ca section

[ CA_default ]
dir		= ./		        # Where everything is kept
new_certs_dir   = $dir/newCreatedCerts
database	= $dir/caDatabase/index.txt	# database index file.
unique_subject	= no			# Set to 'no' to allow creation of
serial		= $dir/caDatabase/serial 		# The current serial number
name_opt 	= ca_default		# Subject Name options
cert_opt 	= ca_default		# Certificate field options
copy_extensions = copy

default_days	= 365			# how long to certify for
default_crl_days= 30			# how long before next CRL
default_md	= sha256		# use SHA-256 by default
preserve	= no			# keep passed DN ordering
policy		= policy_match

# For the CA policy
[ policy_match ]
countryName		= match
stateOrProvinceName	= match
organizationName	= match
organizationalUnitName	= optional
commonName		= supplied
emailAddress		= optional

# For the 'anything' policy
[ policy_anything ]
countryName		= optional
stateOrProvinceName	= optional
localityName		= optional
organizationName	= optional
organizationalUnitName	= optional
commonName		= supplied
emailAddress		= optional

[ req ]
default_bits		= 2048
default_md		= sha256
default_keyfile 	= privkey.pem
distinguished_name	= req_distinguished_name
attributes		= req_attributes

# The extensions to add to the self signed cert (This CA will be signing its own certificate, hence self signed)
x509_extensions	= v3_ca	
string_mask = utf8only

[ req_distinguished_name ]
countryName			= Country Name (2 letter code)
countryName_default		= XX
countryName_min			= 2
countryName_max			= 2
stateOrProvinceName		= State or Province Name (full name)
localityName			= Locality Name (eg, city)
localityName_default		= Default City
0.organizationName		= Organization Name (eg, company)
0.organizationName_default	= Default Company Ltd
organizationalUnitName		= Organizational Unit Name (eg, section)
commonName			= Common Name (eg, your name or your server\'s hostname)
commonName_max			= 64
emailAddress			= Email Address
emailAddress_max		= 64

[ req_attributes ]
challengePassword		= A challenge password
challengePassword_min		= 4
challengePassword_max		= 20
unstructuredName		= An optional company name

[ v3_ca ]
subjectKeyIdentifier=hash
authorityKeyIdentifier=keyid:always,issuer
basicConstraints = critical,CA:true
nsCertType = sslCA, emailCA
</code></pre><pre><code>$ cat opensslConf/csr_openssl.cnf 
[ req ]
default_bits		= 2048
default_md		= sha256
default_keyfile 	= privkey.pem
distinguished_name	= req_distinguished_name
attributes              = req_attributes
string_mask = utf8only

[ req_distinguished_name ]
countryName			= Country Name (2 letter code)
countryName_default		= XX
countryName_min			= 2
countryName_max			= 2
stateOrProvinceName		= State or Province Name (full name)
localityName			= Locality Name (eg, city)
localityName_default		= Default City
0.organizationName		= Organization Name (eg, company)
0.organizationName_default	= Default Company Ltd
organizationalUnitName		= Organizational Unit Name (eg, section)
#organizationalUnitName_default	=
commonName			= Common Name (eg, your name or your server\'s hostname)
commonName_max			= 64
emailAddress			= Email Address
emailAddress_max		= 64

[ req_attributes ]
challengePassword               = A challenge password
challengePassword_min           = 4
challengePassword_max           = 20
unstructuredName                = An optional company name

[ server ]
basicConstraints=CA:FALSE
nsCertType			= server
keyUsage = nonRepudiation, digitalSignature, keyEncipherment
nsComment			= &quot;OpenSSL Generated Certificate&quot;
subjectKeyIdentifier=hash
extendedKeyUsage = serverAuth
subjectAltName = @san_names

[ client ]
basicConstraints=CA:FALSE
nsCertType			= client, email
keyUsage = nonRepudiation, digitalSignature, keyEncipherment
nsComment			= &quot;OpenSSL Generated Certificate&quot;
subjectKeyIdentifier=hash
extendedKeyUsage = clientAuth
subjectAltName = @san_names
</code></pre><pre><code>$ cat opensslConf/server_san_names.cnf 
[ san_names ]
DNS.1 = myhost.full.domain.name
</code></pre><pre><code>$ cat opensslConf/client_san_names.cnf 
[ san_names ]
DNS.1 = client.full.domain.name
</code></pre><h2 id="create-self-signed-ca-certificate">Create self signed CA certificate.</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd myPKI
$ openssl req -config opensslConf/CA_openssl.cnf <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-new -x509 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-out caCert/myCA.crt <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-newkey rsa:2048 -keyout caCert/myCAkey.pem <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-extensions v3_ca <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-days <span style="color:#ae81ff">1000</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-subj <span style="color:#e6db74">&#34;/emailAddress=user@junkemail.com/C=GB/ST=London/L=City of London/O=My Organization/OU=Engg/CN=root CA&#34;</span>

Generating a RSA private key
...........................+++++
.....................+++++
writing new private key to <span style="color:#e6db74">&#39;caCert/myCAkey.pem&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -1 caCert/
myCA.crt
myCAkey.pem
</code></pre></div><h2 id="check-ca-certificate">Check CA certificate</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="verify-ca-certificate">Verify CA certificate</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Note:</strong> Above verification failed because this CA cert is self signed and is NOT issued by certified authority.</p>
<p>Run following command to tell <code>openssl</code> to use our signed CA cert.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ openssl verify -CAfile caCert/myCA.crt -verbose  caCert/myCA.crt

caCert/myCA.crt: OK
</code></pre></div><h2 id="create-a-csr-request-for-server">Create a CSR request for server.</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -1 CSRs/
server.csr
</code></pre></div><h2 id="create-a-csr-request-for-client">Create a CSR request for client.</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -og privateKeys/
total <span style="color:#ae81ff">8</span>
-rw-------. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1704</span> Aug  <span style="color:#ae81ff">3</span> 13:03 myClientKey.pem
-rw-------. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1704</span> Aug  <span style="color:#ae81ff">3</span> 12:17 serverKey.pem

$ ls -og CSRs/
total <span style="color:#ae81ff">8</span>
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1350</span> Aug  <span style="color:#ae81ff">3</span> 13:03 myClient.csr
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1358</span> Aug  <span style="color:#ae81ff">3</span> 12:17 server.csr
</code></pre></div><h3 id="check-server-csr-request">Check Server CSR request</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="check-client-csr-request">Check client CSR request</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="sign-server-csr-and-generate-server-certificate">Sign Server CSR and generate server certificate</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -og  newCreatedCerts/
total <span style="color:#ae81ff">16</span>
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5035</span> Aug  <span style="color:#ae81ff">3</span> 12:40 10.pem
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5035</span> Aug  <span style="color:#ae81ff">3</span> 12:40 serverCert.pem
</code></pre></div><h3 id="check-signed-server-certificate">check signed server certificate</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h3 id="verify-server-certificate">Verify server certificate</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ openssl verify  -CAfile caCert/myCA.crt newCreatedCerts/serverCert.pem

newCreatedCerts/serverCert.pem: OK
</code></pre></div><h2 id="sign-client-csr-and-generate-client-certificate">Sign client CSR and generate client certificate</h2>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -og newCreatedCerts/
total <span style="color:#ae81ff">32</span>
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5035</span> Aug  <span style="color:#ae81ff">3</span> 12:40 10.pem
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5034</span> Aug  <span style="color:#ae81ff">3</span> 13:18 11.pem
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5034</span> Aug  <span style="color:#ae81ff">3</span> 13:18 myClientCert.pem
-rw-rw-r--. <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">5035</span> Aug  <span style="color:#ae81ff">3</span> 12:40 serverCert.pem
</code></pre></div><h3 id="check-client-certificate">check client certificate</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="verify-clientserver-connectivity-using-certs">Verify Client/Server connectivity using certs.</h2>
<p>Please note that our server certificate was created using <code>CN=myhost.full.domain.name</code>. This is imaginary hostname but client must use <code>myhost.full.domain.name</code> to connect to server.</p>
<p>Create a test html file <code>atest.html</code> that will be served by openssl server.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd myPKI
$ mkdir -p serveContent
$ touch serveContent/atest.html
$ <span style="color:#f92672">(</span> cat <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">openssl page served.
</span><span style="color:#e6db74">EOF</span>
<span style="color:#f92672">)</span> &gt; serveContent/atest.html
</code></pre></div><h2 id="attemps-to-connect-and-fetch-a-page-from-server-no-mutual-auth">Attemps to connect and fetch a page from server (NO mutual auth)</h2>
<p>Start a SSL server.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ host myhost.full.domain.name
Host myhost.full.domain.name not found: 3<span style="color:#f92672">(</span>NXDOMAIN<span style="color:#f92672">)</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ openssl s_server <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-accept <span style="color:#ae81ff">9999</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-CAfile caCert/myCA.crt <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-cert newCreatedCerts/serverCert.pem <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-key privateKeys/serverKey.pem <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-state <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>-WWW

Using default temp DH parameters
ACCEPT
</code></pre></div><h4 id="fetch-atesthtml-file-insecurely">Fetch <code>atest.html</code> file <code>insecurely</code>.</h4>
<p>insecure fetch</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h4 id="fetch-atesthtml-file-securely">Fetch <code>atest.html</code> file <code>securely</code>.</h4>
<p>secure fetch</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Note:</strong> The error above is due to the mismatch between client calling the server name as <code>localhost</code> and certificate's <code>SAN</code> name as <code>myhost.full.domain.name</code></p>
<h4 id="fetch-atesthtml-file-with-correct-server-hostname">Fetch <code>atest.html</code> file with correct server hostname</h4>
<p>using correct server name</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl https://myhost.full.domain.name:9999/serveContent/atest.html --cacert caCert/myCA.crt

curl: <span style="color:#f92672">(</span>6<span style="color:#f92672">)</span> Could not resolve host: myhost.full.domain.name
</code></pre></div><h4 id="fixing-dns-resolution-for-myhostfulldomainname">Fixing DNS resolution for <code>myhost.full.domain.name</code></h4>
<p>fix DNS resolution
As <code>root</code> user enter the following line in <code>/etc/resolv.conf</code> file above all <code>nameserver</code> lines.</p>
<pre><code>nameserver 127.0.0.1
</code></pre><h4 id="start-a-temp-dns-server-as-following">Start a temp <code>DNS</code> server as following</h4>
<p>DNS server starting.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ host myhost.full.domain.name
myhost.full.domain.name has address 127.0.0.1
</code></pre></div><h4 id="fetch-atesthtml-file-securely-after-dns-resolution-fix">Fetch <code>atest.html</code> file securely after DNS resolution fix.</h4>
<p>secure fetch.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="attemps-to-connect-and-fetch-a-page-from-server-with-mutual-auth">Attemps to connect and fetch a page from server (WITH mutual auth)</h2>
<h3 id="start-openssl-server-in-client-verification-mode">Start openssl server in client verification mode.</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h4 id="fetch-atesthtml-in-insecure-way">Fetch <code>atest.html</code> in <code>insecure</code> way</h4>
<p>insecure fetch</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl https://myhost.full.domain.name:9999/serveContent/atest.html <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--insecure

curl: <span style="color:#f92672">(</span>56<span style="color:#f92672">)</span> OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 alert certificate required, errno <span style="color:#ae81ff">0</span>
</code></pre></div><h4 id="fetch-atesthtml-secure-way">Fetch <code>atest.html</code> secure way</h4>
<p>secure fetch</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl https://myhost.full.domain.name:9999/serveContent/atest.html <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--cacert caCert/myCA.crt

curl: <span style="color:#f92672">(</span>56<span style="color:#f92672">)</span> OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 alert certificate required, errno <span style="color:#ae81ff">0</span>
</code></pre></div><h4 id="fetch-atesthtml-secure-way-using-client-certs-mutual-auth">Fetch <code>atest.html</code> secure way using client certs (mutual auth)</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ curl https://myhost.full.domain.name:9999/serveContent/atest.html <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--cacert caCert/myCA.crt <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--cert newCreatedCerts/myClientCert.pem <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--key privateKeys/myClientKey.pem

openssl page served.
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/ssl/" rel="tag">SSL</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/openssl/" rel="tag">openssl</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/digital-certificates/" rel="tag">Digital Certificates</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/pki/" rel="tag">pki</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/ssl-mutual-authentication/" rel="tag">SSL mutual authentication</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/x509/" rel="tag">x509</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/ca/" rel="tag">CA</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/curl/" rel="tag">curl</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<div class="authorbox__header">
		<span class="authorbox__name">About SpareSlant</span>
	</div>
</div>

<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/posts/docker-logging-with-rsyslog/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">Docker Logging With Rsyslog</p></a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 SpareSlant.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script></body>
</html>